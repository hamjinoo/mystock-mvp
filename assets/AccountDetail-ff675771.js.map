{"version":3,"file":"AccountDetail-ff675771.js","sources":["../../src/pages/AccountDetail.tsx"],"sourcesContent":["import {\r\n  ArrowLeftIcon,\r\n  PencilIcon,\r\n  PlusIcon,\r\n} from \"@heroicons/react/24/outline\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { Link, useNavigate, useParams } from \"react-router-dom\";\r\nimport { LoadingSpinner } from \"../components/LoadingSpinner\";\r\nimport { AccountService } from \"../services/accountService\";\r\nimport { PortfolioService } from \"../services/portfolioService\";\r\nimport { Account, Portfolio, Position } from \"../types\";\r\nimport { formatCurrency } from \"../utils/currencyUtils\";\r\n\r\ninterface AccountSummary {\r\n  account: Account;\r\n  portfolios: (Portfolio & { positions: Position[] })[];\r\n  totalValue: number;\r\n  totalCost: number;\r\n  returnRate: number;\r\n}\r\n\r\nexport const AccountDetailPage: React.FC = () => {\r\n  const { accountId } = useParams<{ accountId: string }>();\r\n  const navigate = useNavigate();\r\n  const [account, setAccount] = useState<\r\n    Account & { portfolios: (Portfolio & { positions: Position[] })[] }\r\n  >();\r\n  const [summary, setSummary] = useState<AccountSummary>();\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, [accountId]);\r\n\r\n  const loadData = async () => {\r\n    if (!accountId) return;\r\n\r\n    try {\r\n      const [accountData, summaryData] = await Promise.all([\r\n        AccountService.getWithPortfolios(Number(accountId)),\r\n        AccountService.getAccountSummary(Number(accountId)),\r\n      ]);\r\n\r\n      setAccount(accountData);\r\n      setSummary(summaryData);\r\n    } catch (error) {\r\n      console.error(\"계좌 정보 로딩 중 오류:\", error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeletePosition = async (positionId: number) => {\r\n    if (!window.confirm(\"정말 이 포지션을 삭제하시겠습니까?\")) return;\r\n\r\n    try {\r\n      await PortfolioService.deletePosition(positionId);\r\n      loadData(); // 데이터 새로고침\r\n    } catch (error) {\r\n      console.error(\"포지션 삭제 중 오류:\", error);\r\n      alert(\"포지션 삭제에 실패했습니다.\");\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <div className=\"flex justify-center items-center h-64\">\r\n          <LoadingSpinner />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!account || !summary) {\r\n    return (\r\n      <div className=\"p-4\">\r\n        <div className=\"text-center\">\r\n          <p className=\"text-gray-400\">계좌를 찾을 수 없습니다.</p>\r\n          <Link\r\n            to=\"/accounts\"\r\n            className=\"inline-block mt-4 text-blue-500 hover:text-blue-400\"\r\n          >\r\n            계좌 목록으로 돌아가기\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // 모든 포지션을 하나의 배열로 합치기\r\n  const allPositions = summary.portfolios.flatMap((portfolio) =>\r\n    portfolio.positions.map((position) => ({\r\n      ...position,\r\n      portfolioId: portfolio.id,\r\n    }))\r\n  );\r\n\r\n  return (\r\n    <div className=\"p-4\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <button\r\n            onClick={() => navigate(\"/accounts\")}\r\n            className=\"text-sm text-gray-400 hover:text-white flex items-center\"\r\n          >\r\n            <ArrowLeftIcon className=\"h-4 w-4 mr-1\" />\r\n            뒤로\r\n          </button>\r\n          <Link\r\n            to={`/accounts/${accountId}/edit`}\r\n            className=\"text-sm text-gray-400 hover:text-white flex items-center\"\r\n          >\r\n            <PencilIcon className=\"h-4 w-4 mr-1\" />\r\n            수정\r\n          </Link>\r\n        </div>\r\n\r\n        <div className=\"bg-gray-800 rounded-lg p-6 mb-6\">\r\n          <h1 className=\"text-2xl font-bold mb-4\">\r\n            {summary.account.accountName}\r\n          </h1>\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <div>\r\n              <p className=\"text-sm text-gray-400\">증권사</p>\r\n              <p className=\"font-medium\">{summary.account.broker}</p>\r\n            </div>\r\n            <div>\r\n              <p className=\"text-sm text-gray-400\">계좌번호</p>\r\n              <p className=\"font-medium\">{summary.account.accountNumber}</p>\r\n            </div>\r\n            <div>\r\n              <p className=\"text-sm text-gray-400\">총자산</p>\r\n              <p className=\"font-medium\">\r\n                {formatCurrency(summary.totalValue, summary.account.currency)}\r\n              </p>\r\n            </div>\r\n            <div>\r\n              <p className=\"text-sm text-gray-400\">수익률</p>\r\n              <p\r\n                className={`font-medium ${\r\n                  summary.returnRate >= 0 ? \"text-green-400\" : \"text-red-400\"\r\n                }`}\r\n              >\r\n                {summary.returnRate.toFixed(2)}%\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"space-y-6\">\r\n          <div>\r\n            <div className=\"overflow-x-auto\">\r\n              <div className=\"flex justify-between items-center mb-4\">\r\n                <h2 className=\"text-xl font-bold\">보유 종목</h2>\r\n                <Link\r\n                  to={`/accounts/${accountId}/positions/new`}\r\n                  className=\"inline-flex items-center px-3 py-2 text-sm bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n                >\r\n                  <PlusIcon className=\"h-4 w-4 mr-1\" />새 종목 추가\r\n                </Link>\r\n              </div>\r\n              <table className=\"w-full\">\r\n                <thead>\r\n                  <tr className=\"text-left text-sm text-gray-400\">\r\n                    <th className=\"p-2\">종목</th>\r\n                    <th className=\"p-2\">포트폴리오</th>\r\n                    <th className=\"p-2 text-right\">수량</th>\r\n                    <th className=\"p-2 text-right\">평균단가</th>\r\n                    <th className=\"p-2 text-right\">현재가</th>\r\n                    <th className=\"p-2 text-right\">평가금액</th>\r\n                    <th className=\"p-2 text-right\">비중</th>\r\n                    <th className=\"p-2 text-right\">수익률</th>\r\n                    <th className=\"p-2\"></th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {allPositions.map((position) => {\r\n                    const returnRate =\r\n                      ((position.currentPrice - position.avgPrice) /\r\n                        position.avgPrice) *\r\n                      100;\r\n                    const totalValue =\r\n                      position.quantity * position.currentPrice;\r\n                    const percentage = (totalValue / summary.totalValue) * 100;\r\n                    const portfolio = summary.portfolios.find(\r\n                      (p) => p.id === position.portfolioId\r\n                    );\r\n\r\n                    return (\r\n                      <tr\r\n                        key={position.id}\r\n                        className=\"border-t border-gray-700\"\r\n                      >\r\n                        <td className=\"p-2\">\r\n                          <div>\r\n                            <div className=\"font-medium\">{position.symbol}</div>\r\n                            <div className=\"text-sm text-gray-400\">\r\n                              {position.name}\r\n                            </div>\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"p-2\">\r\n                          {portfolio && (\r\n                            <Link\r\n                              to={`/portfolios/${portfolio.id}`}\r\n                              className=\"text-blue-500 hover:text-blue-400\"\r\n                            >\r\n                              <div className=\"text-sm\">\r\n                                <div>{portfolio.name}</div>\r\n                                <div className=\"text-xs text-gray-400\">\r\n                                  {portfolio.config?.period || \"미분류\"}\r\n                                </div>\r\n                              </div>\r\n                            </Link>\r\n                          )}\r\n                        </td>\r\n                        <td className=\"p-2 text-right\">\r\n                          {position.quantity.toLocaleString()}\r\n                        </td>\r\n                        <td className=\"p-2 text-right\">\r\n                          {formatCurrency(\r\n                            position.avgPrice,\r\n                            summary.account.currency\r\n                          )}\r\n                        </td>\r\n                        <td className=\"p-2 text-right\">\r\n                          {formatCurrency(\r\n                            position.currentPrice,\r\n                            summary.account.currency\r\n                          )}\r\n                        </td>\r\n                        <td className=\"p-2 text-right\">\r\n                          {formatCurrency(totalValue, summary.account.currency)}\r\n                        </td>\r\n                        <td className=\"p-2 text-right\">\r\n                          {percentage.toFixed(2)}%\r\n                        </td>\r\n                        <td className=\"p-2 text-right\">\r\n                          <span\r\n                            className={\r\n                              returnRate >= 0\r\n                                ? \"text-green-400\"\r\n                                : \"text-red-400\"\r\n                            }\r\n                          >\r\n                            {returnRate.toFixed(2)}%\r\n                          </span>\r\n                        </td>\r\n                        <td className=\"p-2 text-right\">\r\n                          <div className=\"flex justify-end space-x-2\">\r\n                            <Link\r\n                              to={`/accounts/${accountId}/positions/${position.id}/edit`}\r\n                              className=\"text-gray-400 hover:text-white\"\r\n                            >\r\n                              <PencilIcon className=\"h-4 w-4\" />\r\n                            </Link>\r\n                            <button\r\n                              onClick={() => handleDeletePosition(position.id)}\r\n                              className=\"text-gray-400 hover:text-red-500\"\r\n                            >\r\n                              ×\r\n                            </button>\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n"],"names":["AccountDetailPage","accountId","useParams","navigate","useNavigate","account","setAccount","useState","summary","setSummary","loading","setLoading","useEffect","loadData","async","accountData","summaryData","Promise","all","AccountService","getWithPortfolios","Number","getAccountSummary","error","jsx","className","children","LoadingSpinner","jsxs","Link","to","allPositions","portfolios","flatMap","portfolio","positions","map","position","portfolioId","id","onClick","ArrowLeftIcon","PencilIcon","accountName","broker","accountNumber","formatCurrency","totalValue","currency","returnRate","toFixed","PlusIcon","currentPrice","avgPrice","quantity","percentage","find","p","symbol","name","config","period","toLocaleString","positionId","window","confirm","PortfolioService","deletePosition","alert","handleDeletePosition"],"mappings":"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"}