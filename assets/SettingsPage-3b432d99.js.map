{"version":3,"file":"SettingsPage-3b432d99.js","sources":["../../src/pages/SettingsPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  createBackup,\r\n  deleteBackup,\r\n  getBackupList,\r\n  restoreBackup,\r\n} from \"../utils/backup\";\r\nimport { db } from \"../services/db\";\r\n\r\nexport const SettingsPage: React.FC = () => {\r\n  const [backupName, setBackupName] = useState(\"\");\r\n  const [backupList, setBackupList] = useState<\r\n    Array<{ timestamp: number; name: string }>\r\n  >([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    loadBackupList();\r\n  }, []);\r\n\r\n  const loadBackupList = () => {\r\n    const list = getBackupList();\r\n    setBackupList(list);\r\n  };\r\n\r\n  const handleCreateBackup = async () => {\r\n    if (!backupName.trim()) {\r\n      setError(\"백업 이름을 입력해주세요.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      setSuccess(null);\r\n\r\n      // DB가 준비되었는지 확인\r\n      if (!db.isOpen()) {\r\n        await db.open();\r\n      }\r\n\r\n      await createBackup(backupName.trim());\r\n      setBackupName(\"\");\r\n      loadBackupList();\r\n      setSuccess(\"백업이 생성되었습니다.\");\r\n    } catch (err) {\r\n      console.error(\"백업 생성 중 오류:\", err);\r\n      setError(\"백업 생성 중 오류가 발생했습니다.\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRestoreBackup = async (timestamp: number) => {\r\n    if (\r\n      !window.confirm(\r\n        \"정말로 이 백업을 복원하시겠습니까? 현재 데이터는 모두 삭제됩니다.\"\r\n      )\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      setSuccess(null);\r\n\r\n      // DB가 준비되었는지 확인\r\n      if (!db.isOpen()) {\r\n        await db.open();\r\n      }\r\n\r\n      await restoreBackup(timestamp);\r\n      setSuccess(\"백업이 복원되었습니다. 페이지를 새로고침합니다.\");\r\n      setTimeout(() => {\r\n        window.location.reload();\r\n      }, 1500);\r\n    } catch (err) {\r\n      console.error(\"백업 복원 중 오류:\", err);\r\n      setError(\"백업 복원 중 오류가 발생했습니다.\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteBackup = async (timestamp: number) => {\r\n    if (!window.confirm(\"이 백업을 삭제하시겠습니까?\")) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      deleteBackup(timestamp);\r\n      loadBackupList();\r\n      setSuccess(\"백업이 삭제되었습니다.\");\r\n    } catch (err) {\r\n      console.error(\"백업 삭제 중 오류:\", err);\r\n      setError(\"백업 삭제 중 오류가 발생했습니다.\");\r\n    }\r\n  };\r\n\r\n  const formatDate = (timestamp: number) => {\r\n    return new Date(timestamp).toLocaleString(\"ko-KR\", {\r\n      year: \"numeric\",\r\n      month: \"2-digit\",\r\n      day: \"2-digit\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-8\">\r\n      <h1 className=\"text-2xl font-bold mb-8\">설정</h1>\r\n\r\n      <div className=\"bg-gray-800 rounded-lg p-6 mb-8\">\r\n        <h2 className=\"text-xl font-semibold mb-4\">데이터베이스 백업</h2>\r\n\r\n        <div className=\"mb-6\">\r\n          <div className=\"flex gap-4 mb-4\">\r\n            <input\r\n              type=\"text\"\r\n              value={backupName}\r\n              onChange={(e) => setBackupName(e.target.value)}\r\n              placeholder=\"백업 이름 입력\"\r\n              className=\"flex-1 px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n            <button\r\n              onClick={handleCreateBackup}\r\n              disabled={isLoading}\r\n              className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50\"\r\n            >\r\n              {isLoading ? \"처리 중...\" : \"백업 생성\"}\r\n            </button>\r\n          </div>\r\n\r\n          {error && <div className=\"text-red-500 mb-4\">{error}</div>}\r\n          {success && <div className=\"text-green-500 mb-4\">{success}</div>}\r\n\r\n          <div className=\"space-y-4\">\r\n            {backupList.map((backup) => (\r\n              <div\r\n                key={backup.timestamp}\r\n                className=\"flex items-center justify-between bg-gray-700 p-4 rounded\"\r\n              >\r\n                <div>\r\n                  <div className=\"font-medium\">{backup.name}</div>\r\n                  <div className=\"text-sm text-gray-400\">\r\n                    {formatDate(backup.timestamp)}\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                  <button\r\n                    onClick={() => handleRestoreBackup(backup.timestamp)}\r\n                    disabled={isLoading}\r\n                    className=\"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50\"\r\n                  >\r\n                    복원\r\n                  </button>\r\n                  <button\r\n                    onClick={() => handleDeleteBackup(backup.timestamp)}\r\n                    disabled={isLoading}\r\n                    className=\"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50\"\r\n                  >\r\n                    삭제\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n\r\n            {backupList.length === 0 && (\r\n              <div className=\"text-center text-gray-400 py-8\">\r\n                저장된 백업이 없습니다.\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n"],"names":["SettingsPage","backupName","setBackupName","useState","backupList","setBackupList","isLoading","setIsLoading","error","setError","success","setSuccess","useEffect","loadBackupList","list","getBackupList","jsxs","className","children","jsx","type","value","onChange","e","target","placeholder","onClick","async","trim","db","isOpen","open","createBackup","err","disabled","map","backup","name","timestamp","Date","toLocaleString","year","month","day","hour","minute","window","confirm","restoreBackup","setTimeout","location","reload","handleRestoreBackup","deleteBackup","handleDeleteBackup","length"],"mappings":"yMASO,MAAMA,EAAyB,KACpC,MAAOC,EAAYC,GAAiBC,WAAS,KACtCC,EAAYC,GAAiBF,EAAAA,SAElC,KACKG,EAAWC,GAAgBJ,YAAS,IACpCK,EAAOC,GAAYN,WAAwB,OAC3CO,EAASC,GAAcR,WAAwB,MAEtDS,EAAAA,WAAU,KACOC,MACd,IAEH,MAAMA,EAAiB,KACrB,MAAMC,EAAOC,IACbV,EAAcS,IAyFd,OAAAE,EAAAA,KAAC,MAAI,CAAAC,UAAU,8BACbC,SAAA,CAACC,EAAAA,IAAA,KAAA,CAAGF,UAAU,0BAA0BC,SAAE,OAE1CF,EAAAA,KAAC,MAAI,CAAAC,UAAU,kCACbC,SAAA,CAACC,EAAAA,IAAA,KAAA,CAAGF,UAAU,6BAA6BC,SAAS,cAEpDF,EAAAA,KAAC,MAAI,CAAAC,UAAU,OACbC,SAAA,CAACF,EAAAA,KAAA,MAAA,CAAIC,UAAU,kBACbC,SAAA,CAAAC,EAAAA,IAAC,QAAA,CACCC,KAAK,OACLC,MAAOpB,EACPqB,SAAWC,GAAMrB,EAAcqB,EAAEC,OAAOH,OACxCI,YAAY,WACZR,UAAU,6FAEZE,EAAAA,IAAC,SAAA,CACCO,QAtGeC,UACrB,GAAC1B,EAAW2B,OAKZ,IACFrB,GAAa,GACbE,EAAS,MACTE,EAAW,MAGNkB,EAAGC,gBACAD,EAAGE,aAGLC,EAAa/B,EAAW2B,QAC9B1B,EAAc,IACCW,IACfF,EAAW,sBACJsB,GAEPxB,EAAS,sBAAqB,CAC9B,QACAF,GAAa,EACf,MAvBEE,EAAS,mBAqGDyB,SAAU5B,EACVW,UAAU,iFAETC,WAAY,UAAY,aAI5BV,GAASW,EAAAA,IAAC,MAAI,CAAAF,UAAU,oBAAqBC,SAAMV,IACnDE,GAAWS,EAAAA,IAAC,MAAI,CAAAF,UAAU,sBAAuBC,SAAQR,IAE1DM,EAAAA,KAAC,MAAI,CAAAC,UAAU,YACZC,SAAA,CAAWd,EAAA+B,KAAKC,IACfpB,SAAAA,KAAC,MAAA,CAECC,UAAU,4DAEVC,SAAA,CAAAF,OAAC,MACC,CAAAE,SAAA,CAAAC,EAAAA,IAAC,MAAI,CAAAF,UAAU,cAAeC,SAAAkB,EAAOC,aACpC,MAAI,CAAApB,UAAU,wBACZC,UA/CCoB,EA+CUF,EAAOE,UA9C5B,IAAIC,KAAKD,GAAWE,eAAe,QAAS,CACjDC,KAAM,UACNC,MAAO,UACPC,IAAK,UACLC,KAAM,UACNC,OAAQ,kBA4CE7B,EAAAA,KAAC,MAAI,CAAAC,UAAU,aACbC,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACCO,QAAS,IAnGCC,OAAOW,IACjC,GACGQ,OAAOC,QACN,yCAMA,IACFxC,GAAa,GACbE,EAAS,MACTE,EAAW,MAGNkB,EAAGC,gBACAD,EAAGE,aAGLiB,EAAcV,GACpB3B,EAAW,8BACXsC,YAAW,KACTH,OAAOI,SAASC,WACf,YACIlB,GAEPxB,EAAS,sBAAqB,CAC9B,QACAF,GAAa,EACf,GAsE+B6C,CAAoBhB,EAAOE,WAC1CJ,SAAU5B,EACVW,UAAU,mFACXC,SAAA,OAGDC,EAAAA,IAAC,SAAA,CACCO,QAAS,IA1EAC,OAAOW,IAChC,GAAKQ,OAAOC,QAAQ,mBAIhB,IACFM,EAAaf,GACEzB,IACfF,EAAW,sBACJsB,GAEPxB,EAAS,sBACX,GA8D+B6C,CAAmBlB,EAAOE,WACzCJ,SAAU5B,EACVW,UAAU,+EACXC,SAAA,YArBEkB,EAAOE,WAzCP,IAACA,KAqEa,IAAtBlC,EAAWmD,cACT,MAAI,CAAAtC,UAAU,iCAAiCC,SAEhD"}