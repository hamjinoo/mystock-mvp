import{r as e,j as t}from"./react-265ec861.js";import{C as s}from"./CurrencyInput-1751f9bd.js";import{L as r}from"./index-65335e1b.js";import{A as a}from"./accountService-26154c96.js";import{P as n}from"./portfolioService-3819a654.js";import{j as c,b as l}from"./vendor-936e0d4d.js";import"./dexie-e331f4d1.js";import"./currencyUtils-b432909e.js";import"./router-a48e489e.js";const i=()=>{const{accountId:i,positionId:o}=c(),u=l(),[d,m]=e.useState(),[x,p]=e.useState([]),[f,b]=e.useState(),[g,y]=e.useState(!0),[j,h]=e.useState(""),[v,N]=e.useState(""),[C,S]=e.useState(0),[I,w]=e.useState(0),[E,P]=e.useState(0),[k,q]=e.useState(),[A,R]=e.useState("UNCATEGORIZED");e.useEffect((()=>{T()}),[i,o]);const T=async()=>{if(i&&o)try{const[e,t,s]=await Promise.all([a.getById(Number(i)),n.getAll(),n.getPositionById(Number(o))]);if(!e||!s)throw new Error("데이터를 찾을 수 없습니다.");m(e),p(t),b(s),h(s.symbol),N(s.name),S(s.quantity),w(s.avgPrice),P(s.currentPrice),q(s.portfolioId),R(s.strategyCategory)}catch(e){}finally{y(!1)}},O=x.find((e=>e.id===k)),U=O?.currency||d?.currency||"KRW";if(g)return t.jsx("div",{className:"container mx-auto px-4 py-8",children:t.jsx("div",{className:"flex justify-center items-center h-64",children:t.jsx(r,{})})});if(!d||!f)return t.jsx("div",{className:"p-4",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-400",children:"데이터를 찾을 수 없습니다."}),t.jsx("button",{onClick:()=>u("/accounts"),className:"mt-4 text-blue-500 hover:text-blue-400",children:"계좌 목록으로 돌아가기"})]})});return t.jsx("div",{className:"container mx-auto px-4 py-8",children:t.jsxs("div",{className:"max-w-2xl mx-auto",children:[t.jsx("h1",{className:"text-2xl font-bold mb-8",children:"포지션 수정"}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),i&&o&&k)try{await n.updatePosition(Number(o),{portfolioId:k,symbol:j.trim().toUpperCase(),name:v.trim()||j.trim().toUpperCase(),quantity:C,avgPrice:I,currentPrice:E,strategyCategory:A});const e=x.find((e=>e.id===k)),t=e?e.accountId:i;u(`/accounts/${t}`)}catch(t){alert("포지션 수정에 실패했습니다.")}},className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"종목 코드"}),t.jsx("input",{type:"text",value:j,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"예: AAPL, 005930",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"종목명"}),t.jsx("input",{type:"text",value:v,onChange:e=>N(e.target.value),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"예: Apple Inc., 삼성전자"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"포트폴리오"}),t.jsx("select",{value:k,onChange:e=>q(Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:x.map((e=>t.jsxs("option",{value:e.id,children:[e.name," (",e.config?.period||"미분류",") -"," ",e.currency]},e.id)))}),t.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["현재 계좌: ",d.accountName," (",d.broker,")"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"투자 전략 카테고리"}),t.jsx("select",{value:A,onChange:e=>R(e.target.value),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries({LONG_TERM:"장기 투자",MID_TERM:"중기 투자",SHORT_TERM:"단기 투자",UNCATEGORIZED:"미분류"}).map((([e,s])=>t.jsx("option",{value:e,children:s},e)))})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"수량"}),t.jsx("input",{type:"number",value:C,onChange:e=>S(Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"1",placeholder:"예: 10",required:!0})]}),t.jsx(s,{label:"평균단가",value:I,onChange:w,currency:U,required:!0,type:"price"}),t.jsx(s,{label:"현재가",value:E,onChange:P,currency:U,required:!0,type:"price"})]}),t.jsxs("div",{className:"flex justify-end space-x-4",children:[t.jsx("button",{type:"button",onClick:()=>{const e=x.find((e=>e.id===k)),t=e?e.accountId:i;u(`/accounts/${t}`)},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"취소"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"저장"})]})]})]})})};export{i as EditPosition};
//# sourceMappingURL=EditPosition-d472cc89.js.map
