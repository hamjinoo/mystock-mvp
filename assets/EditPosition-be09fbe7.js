import{j as e,L as t}from"./index-e48b942e.js";import{e as s,u as r,r as a}from"./react-2981e50d.js";import{C as n}from"./CurrencyInput-4b339662.js";import{A as c}from"./accountService-f5f42876.js";import{P as l}from"./portfolioService-309953aa.js";import"./dexie-5294e5fd.js";import"./currencyUtils-b432909e.js";const i=()=>{const{accountId:i,positionId:o}=s(),u=r(),[d,m]=a.useState(),[x,p]=a.useState([]),[f,g]=a.useState(),[b,y]=a.useState(!0),[h,j]=a.useState(""),[v,N]=a.useState(""),[C,S]=a.useState(0),[I,w]=a.useState(0),[E,P]=a.useState(0),[k,A]=a.useState(),[q,R]=a.useState("UNCATEGORIZED");a.useEffect(()=>{T()},[i,o]);const T=async()=>{if(i&&o)try{const[e,t,s]=await Promise.all([c.getById(Number(i)),l.getAll(),l.getPositionById(Number(o))]);if(!e||!s)throw new Error("데이터를 찾을 수 없습니다.");m(e),p(t),g(s),j(s.symbol),N(s.name),S(s.quantity),w(s.avgPrice),P(s.currentPrice),A(s.portfolioId),R(s.strategyCategory)}catch(e){}finally{y(!1)}},O=x.find(e=>e.id===k),U=O?.currency||d?.currency||"KRW";if(b)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(t,{})})});if(!d||!f)return e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-400",children:"데이터를 찾을 수 없습니다."}),e.jsx("button",{onClick:()=>u("/accounts"),className:"mt-4 text-blue-500 hover:text-blue-400",children:"계좌 목록으로 돌아가기"})]})});return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-8",children:"포지션 수정"}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),i&&o&&k)try{await l.updatePosition(Number(o),{portfolioId:k,symbol:h.trim().toUpperCase(),name:v.trim()||h.trim().toUpperCase(),quantity:C,avgPrice:I,currentPrice:E,strategyCategory:q});const e=x.find(e=>e.id===k),t=e?e.accountId:i;u(`/accounts/${t}`)}catch(t){alert("포지션 수정에 실패했습니다.")}},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"종목 코드"}),e.jsx("input",{type:"text",value:h,onChange:e=>j(e.target.value),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"예: AAPL, 005930",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"종목명"}),e.jsx("input",{type:"text",value:v,onChange:e=>N(e.target.value),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"예: Apple Inc., 삼성전자"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"포트폴리오"}),e.jsx("select",{value:k,onChange:e=>A(Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:x.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.config?.period||"미분류",") -"," ",t.currency]},t.id))}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["현재 계좌: ",d.accountName," (",d.broker,")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"투자 전략 카테고리"}),e.jsx("select",{value:q,onChange:e=>R(e.target.value),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries({LONG_TERM:"장기 투자",MID_TERM:"중기 투자",SHORT_TERM:"단기 투자",UNCATEGORIZED:"미분류"}).map(([t,s])=>e.jsx("option",{value:t,children:s},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"수량"}),e.jsx("input",{type:"number",value:C,onChange:e=>S(Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"1",placeholder:"예: 10",required:!0})]}),e.jsx(n,{label:"평균단가",value:I,onChange:w,currency:U,required:!0,type:"price"}),e.jsx(n,{label:"현재가",value:E,onChange:P,currency:U,required:!0,type:"price"})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>{const e=x.find(e=>e.id===k),t=e?e.accountId:i;u(`/accounts/${t}`)},className:"px-4 py-2 text-gray-400 hover:text-gray-300",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"저장"})]})]})]})})};export{i as EditPosition};
//# sourceMappingURL=EditPosition-be09fbe7.js.map
