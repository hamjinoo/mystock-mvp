{"version":3,"file":"PortfolioConfigPage-1ab0a8dc.js","sources":["../../src/pages/PortfolioConfigPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport { LoadingSpinner } from \"../components/LoadingSpinner\";\r\nimport { PortfolioService } from \"../services/portfolioService\";\r\nimport { Portfolio, PortfolioConfig } from \"../types\";\r\n\r\nexport const PortfolioConfigPage: React.FC = () => {\r\n  const { id } = useParams<{ id: string }>();\r\n  const navigate = useNavigate();\r\n  const [portfolio, setPortfolio] = useState<Portfolio | null>(null);\r\n  const [accountName, setAccountName] = useState(\"\");\r\n  const [broker, setBroker] = useState(\"\");\r\n  const [accountNumber, setAccountNumber] = useState(\"\");\r\n  const [totalCapital, setTotalCapital] = useState(0);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    loadPortfolio();\r\n  }, [id]);\r\n\r\n  const loadPortfolio = async () => {\r\n    if (!id) return;\r\n    try {\r\n      const data = await PortfolioService.getById(Number(id));\r\n      if (data) {\r\n        setPortfolio(data);\r\n        setAccountName(data.accountName || \"\");\r\n        setBroker(data.broker || \"\");\r\n        setAccountNumber(data.accountNumber || \"\");\r\n        setTotalCapital(data.config?.totalCapital || 0);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"포트폴리오 로딩 중 오류:\", error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!portfolio) return;\r\n\r\n    try {\r\n      const updatedConfig: PortfolioConfig = {\r\n        totalCapital,\r\n        categoryAllocations: portfolio.config?.categoryAllocations || {\r\n          LONG_TERM: {\r\n            targetPercentage: 50,\r\n            maxStockPercentage: 10,\r\n            maxEntries: 3,\r\n          },\r\n          MID_TERM: {\r\n            targetPercentage: 30,\r\n            maxStockPercentage: 7.5,\r\n            maxEntries: 2,\r\n          },\r\n          SHORT_TERM: {\r\n            targetPercentage: 5,\r\n            maxStockPercentage: 5,\r\n            maxEntries: 1,\r\n          },\r\n          UNCATEGORIZED: {\r\n            targetPercentage: 15,\r\n            maxStockPercentage: 100,\r\n            maxEntries: 1,\r\n          },\r\n        },\r\n        period: portfolio.config?.period,\r\n        description: portfolio.config?.description || \"\",\r\n        targetAllocation: portfolio.config?.targetAllocation || 0,\r\n      };\r\n\r\n      await PortfolioService.update(portfolio.id, {\r\n        ...portfolio,\r\n        accountName: accountName.trim(),\r\n        broker: broker.trim(),\r\n        accountNumber: accountNumber.trim(),\r\n        config: updatedConfig,\r\n      });\r\n      navigate(`/accounts/${portfolio.accountId}`);\r\n    } catch (error) {\r\n      console.error(\"포트폴리오 업데이트 중 오류:\", error);\r\n      alert(\"포트폴리오 설정 저장에 실패했습니다.\");\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!portfolio || !window.confirm(\"이 포트폴리오를 삭제하시겠습니까?\"))\r\n      return;\r\n\r\n    try {\r\n      await PortfolioService.delete(portfolio.id);\r\n      navigate(`/accounts/${portfolio.accountId}`);\r\n    } catch (error) {\r\n      console.error(\"포트폴리오 삭제 중 오류:\", error);\r\n      alert(\"포트폴리오 삭제에 실패했습니다.\");\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <div className=\"flex justify-center items-center h-64\">\r\n          <LoadingSpinner />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!portfolio) {\r\n    return (\r\n      <div className=\"p-4 text-center\">\r\n        <p>포트폴리오를 찾을 수 없습니다.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-8\">\r\n      <div className=\"max-w-2xl mx-auto\">\r\n        <h1 className=\"text-2xl font-bold mb-8\">포트폴리오 설정</h1>\r\n\r\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2\">계좌 이름</label>\r\n            <input\r\n              type=\"text\"\r\n              value={accountName}\r\n              onChange={(e) => setAccountName(e.target.value)}\r\n              className=\"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              placeholder=\"예: 장기투자 계좌, 미국주식 계좌\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2\">증권사</label>\r\n            <input\r\n              type=\"text\"\r\n              value={broker}\r\n              onChange={(e) => setBroker(e.target.value)}\r\n              className=\"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              placeholder=\"예: 미래에셋, NH투자증권\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2\">계좌번호</label>\r\n            <input\r\n              type=\"text\"\r\n              value={accountNumber}\r\n              onChange={(e) => setAccountNumber(e.target.value)}\r\n              className=\"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              placeholder=\"계좌번호를 입력하세요\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2\">\r\n              총 자산 규모\r\n            </label>\r\n            <input\r\n              type=\"number\"\r\n              value={totalCapital}\r\n              onChange={(e) => setTotalCapital(Number(e.target.value))}\r\n              className=\"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              min=\"0\"\r\n              step=\"1000\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex justify-between pt-6\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleDelete}\r\n              className=\"px-6 py-2 bg-red-500 text-white rounded hover:bg-red-600\"\r\n            >\r\n              삭제\r\n            </button>\r\n            <div className=\"flex space-x-4\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => navigate(`/accounts/${portfolio.accountId}`)}\r\n                className=\"px-6 py-2 text-gray-400 hover:text-gray-300\"\r\n              >\r\n                취소\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                className=\"px-6 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n              >\r\n                저장\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n"],"names":["PortfolioConfigPage","id","useParams","navigate","useNavigate","portfolio","setPortfolio","useState","accountName","setAccountName","broker","setBroker","accountNumber","setAccountNumber","totalCapital","setTotalCapital","loading","setLoading","useEffect","loadPortfolio","async","data","PortfolioService","getById","Number","config","error","jsx","className","children","LoadingSpinner","jsxs","onSubmit","e","preventDefault","updatedConfig","categoryAllocations","LONG_TERM","targetPercentage","maxStockPercentage","maxEntries","MID_TERM","SHORT_TERM","UNCATEGORIZED","period","description","targetAllocation","update","trim","accountId","alert","type","value","onChange","target","placeholder","min","step","onClick","window","confirm","delete"],"mappings":"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"}