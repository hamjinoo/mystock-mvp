import{j as e,L as s,C as t}from"./index-e48b942e.js";import{e as a,u as n,r as l}from"./react-2981e50d.js";import{P as r}from"./portfolioService-309953aa.js";import{R as i,a as o,C as c,E as m}from"./riskManagementService-c38bc133.js";import{f as x}from"./currencyUtils-b432909e.js";import{A as d}from"./ArrowLeftIcon-57afa31b.js";import{S as u}from"./ShieldCheckIcon-3f143148.js";import{C as g}from"./CurrencyDollarIcon-1e6343ac.js";import"./dexie-5294e5fd.js";import"./accountService-f5f42876.js";const h=()=>{const{portfolioId:h}=a(),b=n(),[j,p]=l.useState(null),[f,y]=l.useState(null),[N,v]=l.useState(!0),[w,C]=l.useState(!1),[k,P]=l.useState(""),[S,L]=l.useState({});l.useEffect(()=>{h&&I()},[h]);const I=async()=>{if(h)try{const[e,s]=await Promise.all([r.getById(Number(h)),i.getOrCreateRules(Number(h))]);p(e||null),y(s),s&&L({maxPositionSize:s.maxPositionSize,maxPositionAmount:s.maxPositionAmount,maxDailyInvestment:s.maxDailyInvestment,maxMonthlyInvestment:s.maxMonthlyInvestment,minCashReserve:s.minCashReserve,maxPortfolioRisk:s.maxPortfolioRisk,maxSectorConcentration:s.maxSectorConcentration,requireConfirmationAbove:s.requireConfirmationAbove,cooldownPeriod:s.cooldownPeriod,maxConsecutiveLosses:s.maxConsecutiveLosses,autoStopLoss:s.autoStopLoss,stopLossPercentage:s.stopLossPercentage,autoTakeProfit:s.autoTakeProfit,takeProfitPercentage:s.takeProfitPercentage,enableWarnings:s.enableWarnings,warningThreshold:s.warningThreshold})}catch(e){}finally{v(!1)}},R=(e,s)=>{L(t=>({...t,[e]:s,portfolioId:Number(h)}))};return N?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(s,{})})}):j?e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("button",{onClick:()=>b(`/portfolios/${j.id}`),className:"text-sm text-gray-400 hover:text-white flex items-center mr-4",children:[e.jsx(d,{className:"h-4 w-4 mr-1"}),"뒤로"]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center",children:[e.jsx(u,{className:"h-6 w-6 mr-2 text-blue-400"}),"투자 규칙 설정"]}),e.jsx("p",{className:"text-gray-400",children:j.name})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{L({maxPositionSize:20,maxPositionAmount:1e6,maxDailyInvestment:5e5,maxMonthlyInvestment:2e6,minCashReserve:10,maxPortfolioRisk:6,maxSectorConcentration:40,requireConfirmationAbove:3e5,cooldownPeriod:24,maxConsecutiveLosses:3,autoStopLoss:!1,stopLossPercentage:10,autoTakeProfit:!1,takeProfitPercentage:20,enableWarnings:!0,warningThreshold:15})},className:"px-4 py-2 text-gray-400 hover:text-white border border-gray-600 rounded",children:"기본값으로 재설정"}),e.jsx("button",{onClick:async()=>{if(h&&S.portfolioId){C(!0);try{await i.updateRules(Number(h),S),P("투자 규칙이 성공적으로 저장되었습니다."),setTimeout(()=>P(""),3e3),I()}catch(e){alert("저장에 실패했습니다.")}finally{C(!1)}}},disabled:w,className:"px-6 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:w?"저장 중...":"저장"})]})]}),k&&e.jsxs("div",{className:"mb-6 p-4 bg-green-900/20 border border-green-500/30 rounded-lg flex items-center",children:[e.jsx(o,{className:"h-5 w-5 text-green-400 mr-2"}),e.jsx("span",{className:"text-green-400",children:k})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx(t,{className:"h-5 w-5 mr-2 text-blue-400"}),"포지션 관리 규칙"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"단일 종목 최대 비중 (%)"}),e.jsx("input",{type:"number",value:S.maxPositionSize||"",onChange:e=>R("maxPositionSize",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"100"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"권장: 10-20% (분산 투자를 위해)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:["단일 종목 최대 금액 (",j.currency,")"]}),e.jsx("input",{type:"number",value:S.maxPositionAmount||"",onChange:e=>R("maxPositionAmount",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"10000",step:"10000"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["현재 설정: ",x(S.maxPositionAmount||0,j.currency)]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:["일일 최대 투자 금액 (",j.currency,")"]}),e.jsx("input",{type:"number",value:S.maxDailyInvestment||"",onChange:e=>R("maxDailyInvestment",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"10000",step:"10000"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"충동적인 대량 매수를 방지합니다"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:["월간 최대 투자 금액 (",j.currency,")"]}),e.jsx("input",{type:"number",value:S.maxMonthlyInvestment||"",onChange:e=>R("maxMonthlyInvestment",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"50000",step:"50000"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"월간 투자 예산을 관리합니다"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx(g,{className:"h-5 w-5 mr-2 text-green-400"}),"포트폴리오 관리 규칙"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"최소 현금 보유율 (%)"}),e.jsx("input",{type:"number",value:S.minCashReserve||"",onChange:e=>R("minCashReserve",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"50"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"비상 자금 확보를 위해"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"최대 포트폴리오 위험도 (1-10)"}),e.jsx("input",{type:"range",value:S.maxPortfolioRisk||5,onChange:e=>R("maxPortfolioRisk",Number(e.target.value)),className:"w-full",min:"1",max:"10"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"안전 (1)"}),e.jsx("span",{className:"font-medium text-white",children:S.maxPortfolioRisk}),e.jsx("span",{children:"위험 (10)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"섹터별 최대 집중도 (%)"}),e.jsx("input",{type:"number",value:S.maxSectorConcentration||"",onChange:e=>R("maxSectorConcentration",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"10",max:"100"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"섹터 분산을 위한 제한"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx(c,{className:"h-5 w-5 mr-2 text-yellow-400"}),"매수 실행 규칙"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:["확인 필요 금액 (",j.currency,")"]}),e.jsx("input",{type:"number",value:S.requireConfirmationAbove||"",onChange:e=>R("requireConfirmationAbove",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"10000",step:"10000"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"이 금액 이상 매수 시 추가 확인"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"재매수 대기 시간 (시간)"}),e.jsx("input",{type:"number",value:S.cooldownPeriod||"",onChange:e=>R("cooldownPeriod",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"168"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"동일 종목 재매수 대기 시간"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"연속 손실 허용 횟수"}),e.jsx("input",{type:"number",value:S.maxConsecutiveLosses||"",onChange:e=>R("maxConsecutiveLosses",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"10"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"이 횟수 초과 시 매수 중단 경고"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx(m,{className:"h-5 w-5 mr-2 text-red-400"}),"손절/익절 규칙"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:S.autoStopLoss||!1,onChange:e=>R("autoStopLoss",e.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-gray-300",children:"자동 손절 활성화"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"손절 기준 (%)"}),e.jsx("input",{type:"number",value:S.stopLossPercentage||"",onChange:e=>R("stopLossPercentage",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"50",disabled:!S.autoStopLoss}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"이 비율 이상 손실 시 자동 매도"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:S.autoTakeProfit||!1,onChange:e=>R("autoTakeProfit",e.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-gray-300",children:"자동 익절 활성화"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"익절 기준 (%)"}),e.jsx("input",{type:"number",value:S.takeProfitPercentage||"",onChange:e=>R("takeProfitPercentage",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"200",disabled:!S.autoTakeProfit}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"이 비율 이상 수익 시 자동 매도"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center",children:[e.jsx(m,{className:"h-5 w-5 mr-2 text-yellow-400"}),"경고 시스템 설정"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center mb-4",children:[e.jsx("input",{type:"checkbox",checked:S.enableWarnings||!1,onChange:e=>R("enableWarnings",e.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-gray-300",children:"위험 경고 시스템 활성화"})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"투자 전 위험 분석 및 경고 메시지를 표시합니다"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"경고 임계값 (%)"}),e.jsx("input",{type:"number",value:S.warningThreshold||"",onChange:e=>R("warningThreshold",Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"5",max:"50",disabled:!S.enableWarnings}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"이 비율 이상 위험 시 경고 표시"})]})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-900/20 border border-blue-500/30 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-400 mb-2",children:"💡 안전 투자 가이드"}),e.jsxs("ul",{className:"text-sm text-blue-300 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"분산 투자:"})," 단일 종목 비중을 20% 이하로 유지하세요"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"현금 관리:"})," 최소 10-20%의 현금을 보유하세요"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"감정 제어:"})," 일일 투자 한도로 충동적 매수를 방지하세요"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"손절 원칙:"})," 미리 정한 손절 기준을 지키세요"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"재매수 대기:"})," 동일 종목 재매수 시 충분한 시간을 두세요"]})]})]})]})}):e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-400",children:"포트폴리오를 찾을 수 없습니다."}),e.jsx("button",{onClick:()=>b("/portfolios"),className:"mt-4 text-blue-500 hover:text-blue-400",children:"포트폴리오 목록으로 돌아가기"})]})})};export{h as InvestmentRulesPage};
//# sourceMappingURL=InvestmentRulesPage-454b1435.js.map
