import{r as e,j as s,A as t,f as c,e as a}from"./react-265ec861.js";import{L as r}from"./router-a48e489e.js";import{L as i}from"./index-65335e1b.js";import{A as l}from"./accountService-26154c96.js";import{P as n}from"./portfolioService-3819a654.js";import{f as x}from"./currencyUtils-b432909e.js";import{j as d,b as m}from"./vendor-936e0d4d.js";import"./dexie-e331f4d1.js";const o=()=>{const{accountId:o}=d(),h=m(),[j,u]=e.useState(),[N,p]=e.useState(),[f,g]=e.useState(!0);e.useEffect((()=>{v()}),[o]);const v=async()=>{if(o)try{const[e,s]=await Promise.all([l.getWithPortfolios(Number(o)),l.getAccountSummary(Number(o))]);u(e),p(s)}catch(e){}finally{g(!1)}};if(f)return s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsx(i,{})})});if(!j||!N)return s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-400",children:"계좌를 찾을 수 없습니다."}),s.jsx(r,{to:"/accounts",className:"inline-block mt-4 text-blue-500 hover:text-blue-400",children:"계좌 목록으로 돌아가기"})]})});const y=N.portfolios.flatMap((e=>e.positions.map((s=>({...s,portfolioId:e.id})))));return s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("button",{onClick:()=>h("/accounts"),className:"text-sm text-gray-400 hover:text-white flex items-center",children:[s.jsx(t,{className:"h-4 w-4 mr-1"}),"뒤로"]}),s.jsxs(r,{to:`/accounts/${o}/edit`,className:"text-sm text-gray-400 hover:text-white flex items-center",children:[s.jsx(c,{className:"h-4 w-4 mr-1"}),"수정"]})]}),s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold mb-4",children:N.account.accountName}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-400",children:"증권사"}),s.jsx("p",{className:"font-medium",children:N.account.broker})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-400",children:"계좌번호"}),s.jsx("p",{className:"font-medium",children:N.account.accountNumber})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-400",children:"총자산"}),s.jsx("p",{className:"font-medium",children:x(N.totalValue,N.account.currency)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-400",children:"수익률"}),s.jsxs("p",{className:"font-medium "+(N.returnRate>=0?"text-green-400":"text-red-400"),children:[N.returnRate.toFixed(2),"%"]})]})]})]}),s.jsx("div",{className:"space-y-6",children:s.jsx("div",{children:s.jsxs("div",{className:"overflow-x-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-xl font-bold",children:"보유 종목"}),s.jsxs(r,{to:`/accounts/${o}/positions/new`,className:"inline-flex items-center px-3 py-2 text-sm bg-blue-500 text-white rounded hover:bg-blue-600",children:[s.jsx(a,{className:"h-4 w-4 mr-1"}),"새 종목 추가"]})]}),s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-sm text-gray-400",children:[s.jsx("th",{className:"p-2",children:"종목"}),s.jsx("th",{className:"p-2",children:"포트폴리오"}),s.jsx("th",{className:"p-2 text-right",children:"수량"}),s.jsx("th",{className:"p-2 text-right",children:"평균단가"}),s.jsx("th",{className:"p-2 text-right",children:"현재가"}),s.jsx("th",{className:"p-2 text-right",children:"평가금액"}),s.jsx("th",{className:"p-2 text-right",children:"비중"}),s.jsx("th",{className:"p-2 text-right",children:"수익률"}),s.jsx("th",{className:"p-2"})]})}),s.jsx("tbody",{children:y.map((e=>{const t=(e.currentPrice-e.avgPrice)/e.avgPrice*100,a=e.quantity*e.currentPrice,i=a/N.totalValue*100,l=N.portfolios.find((s=>s.id===e.portfolioId));return s.jsxs("tr",{className:"border-t border-gray-700",children:[s.jsx("td",{className:"p-2",children:s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:e.symbol}),s.jsx("div",{className:"text-sm text-gray-400",children:e.name})]})}),s.jsx("td",{className:"p-2",children:l&&s.jsx(r,{to:`/portfolios/${l.id}`,className:"text-blue-500 hover:text-blue-400",children:s.jsxs("div",{className:"text-sm",children:[s.jsx("div",{children:l.name}),s.jsx("div",{className:"text-xs text-gray-400",children:l.config?.period||"미분류"})]})})}),s.jsx("td",{className:"p-2 text-right",children:e.quantity.toLocaleString()}),s.jsx("td",{className:"p-2 text-right",children:x(e.avgPrice,N.account.currency)}),s.jsx("td",{className:"p-2 text-right",children:x(e.currentPrice,N.account.currency)}),s.jsx("td",{className:"p-2 text-right",children:x(a,N.account.currency)}),s.jsxs("td",{className:"p-2 text-right",children:[i.toFixed(2),"%"]}),s.jsx("td",{className:"p-2 text-right",children:s.jsxs("span",{className:t>=0?"text-green-400":"text-red-400",children:[t.toFixed(2),"%"]})}),s.jsx("td",{className:"p-2 text-right",children:s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(r,{to:`/accounts/${o}/positions/${e.id}/edit`,className:"text-gray-400 hover:text-white",children:s.jsx(c,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>(async e=>{if(window.confirm("정말 이 포지션을 삭제하시겠습니까?"))try{await n.deletePosition(e),v()}catch(s){alert("포지션 삭제에 실패했습니다.")}})(e.id),className:"text-gray-400 hover:text-red-500",children:"×"})]})})]},e.id)}))})]})]})})})]})})};export{o as AccountDetailPage};
//# sourceMappingURL=AccountDetail-ff675771.js.map
