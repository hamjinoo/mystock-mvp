import{j as e,C as s,B as t,L as a}from"./index-e48b942e.js";import{r as l,e as c,u as r,L as i}from"./react-2981e50d.js";import{f as n}from"./currencyUtils-b432909e.js";import{C as x}from"./CurrencyDollarIcon-1e6343ac.js";import{A as d}from"./accountService-f5f42876.js";import{P as m}from"./portfolioService-309953aa.js";import{A as o}from"./ArrowLeftIcon-57afa31b.js";import{P as h}from"./PencilIcon-855fc7f7.js";import{P as j}from"./PlusIcon-59184969.js";import"./dexie-5294e5fd.js";function u({title:e,titleId:s,...t},a){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},t),e?l.createElement("title",{id:s},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"}))}const N=l.forwardRef(u),p=({cashBalance:a,currency:l,className:c=""})=>{const{totalBalance:r,cashBalance:i,investedAmount:d,currentValue:m,utilizationRate:o,profitLoss:h,profitLossRate:j}=a;return e.jsxs("div",{className:`bg-gray-800 rounded-lg p-6 ${c}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"자금 현황"}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx(s,{className:"h-4 w-4 mr-1"}),"활용률 ",o.toFixed(1),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(t,{className:"h-5 w-5 text-blue-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-400",children:"총 잔고"})]}),e.jsx("p",{className:"text-xl font-bold text-white",children:n(r,l)})]}),e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(x,{className:"h-5 w-5 text-green-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-400",children:"사용 가능 현금"})]}),e.jsx("p",{className:"text-xl font-bold text-green-400",children:n(i,l)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r>0?(i/r*100).toFixed(1):0,"%"]})]}),e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(s,{className:"h-5 w-5 text-purple-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-400",children:"투자 중"})]}),e.jsx("p",{className:"text-xl font-bold text-purple-400",children:n(d,l)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r>0?(d/r*100).toFixed(1):0,"%"]})]})]}),e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"투자 성과"}),e.jsxs("span",{className:"text-sm font-medium "+(h>=0?"text-green-400":"text-red-400"),children:[h>=0?"+":"",j.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"평가 금액"}),e.jsx("p",{className:"text-lg font-bold text-white",children:n(m,l)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"손익"}),e.jsxs("p",{className:"text-lg font-bold "+(h>=0?"text-green-400":"text-red-400"),children:[h>=0?"+":"",n(h,l)]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"w-full bg-gray-600 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(o,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"자금 활용률"}),e.jsxs("span",{children:[o.toFixed(1),"%"]})]})]})]}),i<0&&e.jsx("div",{className:"mt-4 p-3 bg-red-900/30 border border-red-500/50 rounded-lg",children:e.jsx("p",{className:"text-red-400 text-sm",children:"⚠️ 현금 잔고가 부족합니다. 계좌 잔고를 확인해주세요."})}),o>90&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-900/30 border border-yellow-500/50 rounded-lg",children:e.jsx("p",{className:"text-yellow-400 text-sm",children:"💡 자금 활용률이 높습니다. 추가 투자 시 신중하게 검토해주세요."})})]})},g=()=>{const{accountId:s}=c(),t=r(),[x,u]=l.useState(),[g,f]=l.useState(),[b,y]=l.useState(null),[v,w]=l.useState(!0),[P,k]=l.useState(!1),[C,M]=l.useState(0);l.useEffect(()=>{S()},[s]);const S=async()=>{if(s)try{const[e,t,a]=await Promise.all([d.getWithPortfolios(Number(s)),d.getAccountSummary(Number(s)),d.getCashBalance(Number(s))]);u(e),f(t),y(a),M(e.totalBalance||0)}catch(e){}finally{w(!1)}};if(v)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(a,{})})});if(!x||!g)return e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-400",children:"계좌를 찾을 수 없습니다."}),e.jsx(i,{to:"/accounts",className:"inline-block mt-4 text-blue-500 hover:text-blue-400",children:"계좌 목록으로 돌아가기"})]})});const B=g.portfolios.flatMap(e=>e.positions.map(s=>({...s,portfolioId:e.id})));return e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>t("/accounts"),className:"text-sm text-gray-400 hover:text-white flex items-center",children:[e.jsx(o,{className:"h-4 w-4 mr-1"}),"뒤로"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>k(!0),className:"text-sm text-gray-400 hover:text-white flex items-center",children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),"잔고 설정"]}),e.jsxs(i,{to:`/accounts/${s}/edit`,className:"text-sm text-gray-400 hover:text-white flex items-center",children:[e.jsx(h,{className:"h-4 w-4 mr-1"}),"수정"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:g.account.accountName}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"증권사"}),e.jsx("p",{className:"font-medium",children:g.account.broker})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"계좌번호"}),e.jsx("p",{className:"font-medium",children:g.account.accountNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"총자산"}),e.jsx("p",{className:"font-medium",children:n(g.totalValue,g.account.currency)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"수익률"}),e.jsxs("p",{className:"font-medium "+(g.returnRate>=0?"text-green-400":"text-red-400"),children:[g.returnRate.toFixed(2),"%"]})]})]})]}),b&&e.jsx(p,{cashBalance:b,currency:g.account.currency,className:"mb-6"}),P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"계좌 잔고 설정"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["총 계좌 잔고 (",g.account.currency,")"]}),e.jsx("input",{type:"number",value:C,onChange:e=>M(Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"1000"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["현재 투자 중인 금액: ",n(g.totalCost,g.account.currency)]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 text-gray-400 hover:text-white",children:"취소"}),e.jsx("button",{onClick:async()=>{if(s)try{await d.updateAccountBalance(Number(s),C),k(!1),S()}catch(e){alert("계좌 잔고 업데이트에 실패했습니다.")}},className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"저장"})]})]})}),e.jsx("div",{className:"space-y-6",children:e.jsx("div",{children:e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"보유 종목"}),e.jsxs(i,{to:`/accounts/${s}/positions/new`,className:"inline-flex items-center px-3 py-2 text-sm bg-blue-500 text-white rounded hover:bg-blue-600",children:[e.jsx(j,{className:"h-4 w-4 mr-1"}),"새 종목 추가"]})]}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-sm text-gray-400",children:[e.jsx("th",{className:"p-2",children:"종목"}),e.jsx("th",{className:"p-2",children:"포트폴리오"}),e.jsx("th",{className:"p-2 text-right",children:"수량"}),e.jsx("th",{className:"p-2 text-right",children:"평균단가"}),e.jsx("th",{className:"p-2 text-right",children:"현재가"}),e.jsx("th",{className:"p-2 text-right",children:"평가금액"}),e.jsx("th",{className:"p-2 text-right",children:"비중"}),e.jsx("th",{className:"p-2 text-right",children:"수익률"}),e.jsx("th",{className:"p-2"})]})}),e.jsx("tbody",{children:B.map(t=>{const a=(t.currentPrice-t.avgPrice)/t.avgPrice*100,l=t.quantity*t.currentPrice,c=l/g.totalValue*100,r=g.portfolios.find(e=>e.id===t.portfolioId);return e.jsxs("tr",{className:"border-t border-gray-700",children:[e.jsx("td",{className:"p-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.symbol}),e.jsx("div",{className:"text-sm text-gray-400",children:t.name})]})}),e.jsx("td",{className:"p-2",children:r&&e.jsx(i,{to:`/portfolios/${r.id}`,className:"text-blue-500 hover:text-blue-400",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:r.name}),e.jsx("div",{className:"text-xs text-gray-400",children:r.config?.period||"미분류"})]})})}),e.jsx("td",{className:"p-2 text-right",children:t.quantity.toLocaleString()}),e.jsx("td",{className:"p-2 text-right",children:n(t.avgPrice,g.account.currency)}),e.jsx("td",{className:"p-2 text-right",children:n(t.currentPrice,g.account.currency)}),e.jsx("td",{className:"p-2 text-right",children:n(l,g.account.currency)}),e.jsxs("td",{className:"p-2 text-right",children:[c.toFixed(2),"%"]}),e.jsx("td",{className:"p-2 text-right",children:e.jsxs("span",{className:a>=0?"text-green-400":"text-red-400",children:[a.toFixed(2),"%"]})}),e.jsx("td",{className:"p-2 text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(i,{to:`/accounts/${s}/positions/${t.id}/edit`,className:"text-gray-400 hover:text-white",children:e.jsx(h,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>(async e=>{if(window.confirm("정말 이 포지션을 삭제하시겠습니까?"))try{await m.deletePosition(e),S()}catch(s){alert("포지션 삭제에 실패했습니다.")}})(t.id),className:"text-gray-400 hover:text-red-500",children:"×"})]})})]},t.id)})})]})]})})})]})})};export{g as AccountDetailPage};
//# sourceMappingURL=AccountDetail-dda63e07.js.map
