import{j as e,L as t}from"./index-e48b942e.js";import{e as s,u as a,r}from"./react-2981e50d.js";import{C as c}from"./CurrencyInput-4b339662.js";import{A as n}from"./accountService-f5f42876.js";import{P as l}from"./portfolioService-309953aa.js";import"./dexie-5294e5fd.js";import"./currencyUtils-b432909e.js";const i=()=>{const{accountId:i}=s(),o=a(),[u,d]=r.useState(),[m,x]=r.useState([]),[p,b]=r.useState(!0),[h,g]=r.useState(""),[f,j]=r.useState(""),[y,N]=r.useState(0),[v,w]=r.useState(0),[C,S]=r.useState(0),[I,k]=r.useState();r.useEffect(()=>{A()},[i]);const A=async()=>{if(i)try{await l.fixPortfolioData();const e=await n.getById(Number(i));if(!e)throw new Error("ê³„ì¢Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");d(e);const t=await l.getAll();if(x(t),t.length>0){const e=t.filter(e=>e.accountId===Number(i)),s=e.length>0?e[0]:t[0];k(s.id)}}catch(e){}finally{b(!1)}},q=m.find(e=>e.id===I),P=q?.currency||u?.currency||"KRW";return p?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(t,{})})}):u?0===m.length?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"ìƒˆ ì¢…ëª©"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"í¬íŠ¸í´ë¦¬ì˜¤ê°€ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("button",{onClick:()=>o("/portfolios/new"),className:"px-6 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"ìƒˆ í¬íŠ¸í´ë¦¬ì˜¤ ë§Œë“¤ê¸°"})]})}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-8",children:"ìƒˆ ì¢…ëª©"}),e.jsx("div",{className:"mb-4 p-4 bg-blue-900/20 border border-blue-500/30 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-400",children:["ğŸ’¡ ",e.jsx("strong",{children:"íŒ:"})," ì´ì œ ëª¨ë“  í¬íŠ¸í´ë¦¬ì˜¤ì—ì„œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë™ì¼í•œ ì¢…ëª©ì„ ì—¬ëŸ¬ í¬íŠ¸í´ë¦¬ì˜¤ì— ë‚˜ëˆ„ì–´ ê´€ë¦¬í•˜ì—¬ ë¦¬ë°¸ëŸ°ì‹±ì„ ë” ì‰½ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."]})}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),i&&I)try{const e=m.find(e=>e.id===I);if(!e)throw new Error("ì„ íƒí•œ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");const t={portfolioId:I,symbol:h.trim().toUpperCase(),name:f.trim()||h.trim().toUpperCase(),quantity:y,avgPrice:v,currentPrice:C,tradeDate:Date.now(),strategyCategory:e.config?.period||"UNCATEGORIZED",strategyTags:[]};await l.createPosition(t);const s=e.accountId;o(`/accounts/${s}`)}catch(t){alert("í¬ì§€ì…˜ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"í¬íŠ¸í´ë¦¬ì˜¤ ì„ íƒ"}),e.jsx("select",{value:I,onChange:e=>k(Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:m.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.config?.period||"ë¯¸ë¶„ë¥˜",") -"," ",t.currency]},t.id))}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["í˜„ì¬ ê³„ì¢Œ: ",u.accountName," (",u.broker,")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"ì¢…ëª© ì½”ë“œ"}),e.jsx("input",{type:"text",value:h,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ì˜ˆ: AAPL, 005930",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"ì¢…ëª©ëª…"}),e.jsx("input",{type:"text",value:f,onChange:e=>j(e.target.value),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ì˜ˆ: Apple Inc., ì‚¼ì„±ì „ì"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"ìˆ˜ëŸ‰"}),e.jsx("input",{type:"number",value:y,onChange:e=>N(Number(e.target.value)),className:"w-full px-4 py-2 bg-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"1",placeholder:"ì˜ˆ: 10",required:!0})]}),e.jsx(c,{label:"í‰ê· ë‹¨ê°€",value:v,onChange:w,currency:P,required:!0,type:"price"}),e.jsx(c,{label:"í˜„ì¬ê°€",value:C,onChange:S,currency:P,required:!0,type:"price"})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>{const e=m.find(e=>e.id===I),t=e?e.accountId:i;o(`/accounts/${t}`)},className:"px-6 py-2 text-gray-400 hover:text-gray-300",children:"ì·¨ì†Œ"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",disabled:!I||!h.trim()||y<=0||v<=0||C<=0,children:"ìƒì„±"})]})]})]})}):e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-400",children:"ê³„ì¢Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("button",{onClick:()=>o("/accounts"),className:"mt-4 text-blue-500 hover:text-blue-400",children:"ê³„ì¢Œ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°"})]})})};export{i as NewPositionPage,i as default};
//# sourceMappingURL=NewPosition-e07cbcf4.js.map
